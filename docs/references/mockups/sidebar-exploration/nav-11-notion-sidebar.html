<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Nav 11: Notion-Style Sidebar with Dock Behavior</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      :root {
        --background: 40 20% 98%;
        --foreground: 30 10% 12%;
        --card: 40 15% 99%;
        --primary: 38 65% 50%;
        --primary-foreground: 40 20% 98%;
        --secondary: 35 10% 92%;
        --muted: 35 12% 93%;
        --muted-foreground: 30 8% 45%;
        --border: 35 15% 88%;
      }
      .dark {
        --background: 30 15% 8%;
        --foreground: 35 15% 92%;
        --card: 30 12% 11%;
        --primary: 40 55% 55%;
        --primary-foreground: 30 15% 8%;
        --secondary: 30 10% 18%;
        --muted: 30 10% 15%;
        --muted-foreground: 35 10% 55%;
        --border: 30 10% 20%;
      }
      body {
        background-color: hsl(var(--background));
        color: hsl(var(--foreground));
        font-family:
          system-ui,
          -apple-system,
          sans-serif;
      }

      /* Layout */
      .app-container {
        display: flex;
        min-height: 100vh;
        position: relative;
      }
      .app-container.sidebar-right {
        flex-direction: row-reverse;
      }

      /* Main content - shifts when sidebar is open */
      .main-content {
        flex: 1;
        padding: 24px;
        padding-left: 32px;
        transition: padding 0.3s ease;
      }
      .app-container.sidebar-open .main-content {
        padding-left: 24px;
      }
      .app-container.sidebar-right .main-content {
        padding-left: 24px;
        padding-right: 32px;
      }
      .app-container.sidebar-right.sidebar-open .main-content {
        padding-right: 24px;
      }

      /* Toggle button - top corner */
      .sidebar-toggle {
        position: fixed;
        top: 12px;
        left: 12px;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 6px;
        cursor: pointer;
        background: hsl(var(--card));
        border: 1px solid hsl(var(--border));
        z-index: 100;
        transition: all 0.2s ease;
      }
      .sidebar-toggle:hover {
        background: hsl(var(--muted));
      }
      .sidebar-toggle svg {
        width: 16px;
        height: 16px;
        color: hsl(var(--muted-foreground));
      }
      .app-container.sidebar-right .sidebar-toggle {
        left: auto;
        right: 12px;
      }

      /* Sidebar wrapper */
      .sidebar-wrapper {
        position: fixed;
        top: 0;
        left: 0;
        bottom: 0;
        display: flex;
        z-index: 50;
      }
      .app-container.sidebar-right .sidebar-wrapper {
        left: auto;
        right: 0;
        flex-direction: row-reverse;
      }

      /* Color strip - always visible */
      .color-strip {
        width: 8px;
        display: flex;
        flex-direction: column;
        background: hsl(var(--card));
        position: relative;
        z-index: 60;
      }
      .color-segment {
        position: relative;
        cursor: pointer;
        transition: all 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
        transform-origin: left center;
      }
      .app-container.sidebar-right .color-segment {
        transform-origin: right center;
      }

      /* Glow colors */
      .color-ai {
        background: hsl(var(--primary));
      }
      .color-mention {
        background: hsl(350 70% 50%);
      }
      .color-people {
        background: hsl(200 60% 50%);
      }
      .color-quiet {
        background: hsl(var(--muted-foreground) / 0.2);
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }
      .color-pulse {
        animation: pulse 2.5s ease-in-out infinite;
      }

      /* Dock-like magnification on hover */
      .color-segment.magnified {
        transform: scaleX(3);
        z-index: 70;
      }
      .color-segment.neighbor {
        transform: scaleX(1.8);
        z-index: 65;
      }
      .color-segment.far-neighbor {
        transform: scaleX(1.3);
      }

      /* Sidebar panel */
      .sidebar-panel {
        width: 0;
        background: hsl(var(--card));
        border-right: 1px solid hsl(var(--border));
        overflow: hidden;
        transition: width 0.3s ease;
      }
      .app-container.sidebar-right .sidebar-panel {
        border-right: none;
        border-left: 1px solid hsl(var(--border));
      }

      /* When sidebar is open (pinned) - takes up space */
      .app-container.sidebar-open .sidebar-panel {
        width: 252px;
        position: relative;
      }
      .app-container.sidebar-open .sidebar-wrapper {
        position: relative;
      }

      /* When sidebar is closed but hovering - overlay mode */
      .sidebar-panel.preview {
        width: 252px;
        position: absolute;
        left: 8px;
        top: 0;
        bottom: 0;
        box-shadow: 4px 0 16px hsl(var(--foreground) / 0.08);
      }
      .app-container.sidebar-right .sidebar-panel.preview {
        left: auto;
        right: 8px;
        box-shadow: -4px 0 16px hsl(var(--foreground) / 0.08);
      }

      /* Section preview - shows when hovering a color segment */
      .section-preview {
        position: absolute;
        left: 8px;
        background: hsl(var(--card));
        border: 1px solid hsl(var(--border));
        border-radius: 8px;
        box-shadow: 4px 4px 20px hsl(var(--foreground) / 0.1);
        padding: 8px;
        min-width: 200px;
        opacity: 0;
        visibility: hidden;
        transform: translateX(-8px);
        transition: all 0.2s ease;
        z-index: 80;
        pointer-events: none;
      }
      .section-preview.visible {
        opacity: 1;
        visibility: visible;
        transform: translateX(0);
        pointer-events: auto;
      }
      .app-container.sidebar-right .section-preview {
        left: auto;
        right: 8px;
        transform: translateX(8px);
      }
      .app-container.sidebar-right .section-preview.visible {
        transform: translateX(0);
      }

      /* Sidebar content */
      .sidebar-content {
        width: 252px;
        height: 100%;
        overflow-y: auto;
        padding: 52px 8px 8px 8px;
      }

      /* Label groups */
      .label-group {
        margin-bottom: 2px;
      }
      .label-header {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px;
        cursor: pointer;
        border-radius: 8px;
        transition: background 0.15s ease;
      }
      .label-header:hover {
        background: hsl(var(--muted) / 0.5);
      }

      .label-color {
        width: 10px;
        height: 10px;
        border-radius: 3px;
        flex-shrink: 0;
      }
      .label-name {
        font-size: 13px;
        font-weight: 600;
        flex: 1;
      }
      .label-glow {
        width: 4px;
        height: 18px;
        border-radius: 2px;
      }

      /* Stream items */
      .label-items {
        padding: 2px 0 8px 0;
      }
      .stream-item {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 8px 10px 8px 20px;
        border-radius: 6px;
        cursor: pointer;
        transition: background 0.15s ease;
      }
      .stream-item:hover {
        background: hsl(var(--muted) / 0.5);
      }

      .stream-glow {
        width: 3px;
        height: 16px;
        border-radius: 2px;
      }
      .stream-icon {
        width: 20px;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        color: hsl(var(--muted-foreground));
      }
      .stream-name {
        font-size: 12px;
        flex: 1;
      }
      .stream-badge {
        font-size: 9px;
        padding: 2px 5px;
        border-radius: 3px;
        background: hsl(var(--muted));
        color: hsl(var(--muted-foreground));
      }

      /* Neighbor hint in section preview */
      .neighbor-hint {
        padding: 6px 10px;
        font-size: 11px;
        color: hsl(var(--muted-foreground));
        border-radius: 4px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 6px;
        opacity: 0.6;
        transition: all 0.15s ease;
      }
      .neighbor-hint:hover {
        opacity: 1;
        background: hsl(var(--muted) / 0.3);
      }
      .neighbor-hint .hint-color {
        width: 6px;
        height: 6px;
        border-radius: 2px;
      }

      /* Controls */
      .controls {
        position: fixed;
        top: 12px;
        right: 16px;
        display: flex;
        gap: 8px;
        z-index: 100;
      }
      .control-btn {
        padding: 6px 12px;
        font-size: 11px;
        border-radius: 6px;
        cursor: pointer;
        background: hsl(var(--card));
        border: 1px solid hsl(var(--border));
        transition: all 0.15s ease;
      }
      .control-btn:hover {
        background: hsl(var(--muted));
      }
      .control-btn.active {
        background: hsl(var(--primary));
        color: hsl(var(--primary-foreground));
        border-color: hsl(var(--primary));
      }
    </style>
  </head>
  <body>
    <div class="app-container" id="app">
      <div class="controls">
        <button class="control-btn" onclick="toggleSide()">Swap Side</button>
        <button onclick="document.body.classList.toggle('dark')" class="control-btn">Theme</button>
      </div>

      <!-- Toggle button -->
      <button class="sidebar-toggle" id="toggleBtn" onclick="toggleSidebar()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="3" y="3" width="18" height="18" rx="2" />
          <line x1="9" y1="3" x2="9" y2="21" />
        </svg>
      </button>

      <!-- Sidebar wrapper -->
      <div class="sidebar-wrapper" id="sidebarWrapper">
        <!-- Color strip - always visible -->
        <div class="color-strip" id="colorStrip">
          <div class="color-segment color-ai color-pulse" data-section="auth" style="flex: 1.2"></div>
          <div class="color-segment color-mention" data-section="launch" style="flex: 1"></div>
          <div class="color-segment color-people" data-section="design" style="flex: 0.8"></div>
          <div class="color-segment color-quiet" data-section="hiring" style="flex: 0.6"></div>
        </div>

        <!-- Sidebar panel -->
        <div class="sidebar-panel" id="sidebarPanel">
          <div class="sidebar-content">
            <!-- Auth Project -->
            <div class="label-group" data-section="auth">
              <div class="label-header">
                <div class="label-color" style="background: hsl(280 60% 55%)"></div>
                <span class="label-name">Auth Project</span>
                <div class="label-glow" style="background: hsl(var(--primary))"></div>
              </div>
              <div class="label-items">
                <div class="stream-item">
                  <div class="stream-glow" style="background: hsl(var(--primary))"></div>
                  <div class="stream-icon">üìù</div>
                  <span class="stream-name font-medium">Auth Scratchpad</span>
                </div>
                <div class="stream-item" style="color: hsl(var(--muted-foreground))">
                  <div class="stream-glow" style="background: transparent"></div>
                  <div class="stream-icon">#</div>
                  <span class="stream-name"># auth-dev</span>
                </div>
                <div class="stream-item" style="color: hsl(var(--muted-foreground))">
                  <div class="stream-glow" style="background: transparent"></div>
                  <div class="stream-icon">‚Ü©</div>
                  <span class="stream-name">Security review</span>
                  <span class="stream-badge">thread</span>
                </div>
              </div>
            </div>

            <!-- Q1 Launch -->
            <div class="label-group" data-section="launch">
              <div class="label-header">
                <div class="label-color" style="background: hsl(150 60% 45%)"></div>
                <span class="label-name">Q1 Launch</span>
                <div class="label-glow" style="background: hsl(350 70% 50%)"></div>
              </div>
              <div class="label-items">
                <div class="stream-item">
                  <div class="stream-glow" style="background: hsl(350 70% 50%)"></div>
                  <div class="stream-icon">#</div>
                  <span class="stream-name font-semibold"># engineering</span>
                </div>
                <div class="stream-item">
                  <div class="stream-glow" style="background: hsl(200 60% 50%)"></div>
                  <div class="stream-icon">‚Ü©</div>
                  <span class="stream-name">Launch planning</span>
                  <span class="stream-badge">thread</span>
                </div>
              </div>
            </div>

            <!-- Design System -->
            <div class="label-group" data-section="design">
              <div class="label-header">
                <div class="label-color" style="background: hsl(30 70% 50%)"></div>
                <span class="label-name">Design System</span>
                <div class="label-glow" style="background: hsl(200 60% 50%)"></div>
              </div>
              <div class="label-items">
                <div class="stream-item">
                  <div class="stream-glow" style="background: hsl(200 60% 50%)"></div>
                  <div class="stream-icon">#</div>
                  <span class="stream-name"># design</span>
                </div>
                <div class="stream-item" style="color: hsl(var(--muted-foreground))">
                  <div class="stream-glow" style="background: transparent"></div>
                  <div class="stream-icon">üìù</div>
                  <span class="stream-name">Component ideas</span>
                </div>
              </div>
            </div>

            <!-- Hiring -->
            <div class="label-group" data-section="hiring">
              <div class="label-header">
                <div class="label-color" style="background: hsl(200 60% 50%)"></div>
                <span class="label-name" style="color: hsl(var(--muted-foreground))">Hiring</span>
              </div>
              <div class="label-items">
                <div class="stream-item" style="color: hsl(var(--muted-foreground))">
                  <div class="stream-glow" style="background: transparent"></div>
                  <div class="stream-icon">#</div>
                  <span class="stream-name"># hiring</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Section preview popups (for closed state) -->
      <div class="section-preview" id="preview-auth">
        <div class="neighbor-hint" data-target="hiring" style="order: -1">
          <div class="hint-color" style="background: hsl(200 60% 50%)"></div>
          <span>Hiring</span>
        </div>
        <div class="label-header" style="margin: 4px 0">
          <div class="label-color" style="background: hsl(280 60% 55%)"></div>
          <span class="label-name">Auth Project</span>
          <div class="label-glow" style="background: hsl(var(--primary))"></div>
        </div>
        <div class="stream-item" style="padding-left: 10px">
          <div class="stream-glow" style="background: hsl(var(--primary))"></div>
          <div class="stream-icon">üìù</div>
          <span class="stream-name font-medium">Auth Scratchpad</span>
        </div>
        <div class="stream-item" style="padding-left: 10px; color: hsl(var(--muted-foreground))">
          <div class="stream-icon">#</div>
          <span class="stream-name"># auth-dev</span>
        </div>
        <div class="neighbor-hint" data-target="launch">
          <div class="hint-color" style="background: hsl(150 60% 45%)"></div>
          <span>Q1 Launch</span>
        </div>
      </div>

      <div class="section-preview" id="preview-launch">
        <div class="neighbor-hint" data-target="auth" style="order: -1">
          <div class="hint-color" style="background: hsl(280 60% 55%)"></div>
          <span>Auth Project</span>
        </div>
        <div class="label-header" style="margin: 4px 0">
          <div class="label-color" style="background: hsl(150 60% 45%)"></div>
          <span class="label-name">Q1 Launch</span>
          <div class="label-glow" style="background: hsl(350 70% 50%)"></div>
        </div>
        <div class="stream-item" style="padding-left: 10px">
          <div class="stream-glow" style="background: hsl(350 70% 50%)"></div>
          <div class="stream-icon">#</div>
          <span class="stream-name font-semibold"># engineering</span>
        </div>
        <div class="stream-item" style="padding-left: 10px">
          <div class="stream-glow" style="background: hsl(200 60% 50%)"></div>
          <div class="stream-icon">‚Ü©</div>
          <span class="stream-name">Launch planning</span>
        </div>
        <div class="neighbor-hint" data-target="design">
          <div class="hint-color" style="background: hsl(30 70% 50%)"></div>
          <span>Design System</span>
        </div>
      </div>

      <div class="section-preview" id="preview-design">
        <div class="neighbor-hint" data-target="launch" style="order: -1">
          <div class="hint-color" style="background: hsl(150 60% 45%)"></div>
          <span>Q1 Launch</span>
        </div>
        <div class="label-header" style="margin: 4px 0">
          <div class="label-color" style="background: hsl(30 70% 50%)"></div>
          <span class="label-name">Design System</span>
          <div class="label-glow" style="background: hsl(200 60% 50%)"></div>
        </div>
        <div class="stream-item" style="padding-left: 10px">
          <div class="stream-glow" style="background: hsl(200 60% 50%)"></div>
          <div class="stream-icon">#</div>
          <span class="stream-name"># design</span>
        </div>
        <div class="neighbor-hint" data-target="hiring">
          <div class="hint-color" style="background: hsl(200 60% 50%)"></div>
          <span>Hiring</span>
        </div>
      </div>

      <div class="section-preview" id="preview-hiring">
        <div class="neighbor-hint" data-target="design" style="order: -1">
          <div class="hint-color" style="background: hsl(30 70% 50%)"></div>
          <span>Design System</span>
        </div>
        <div class="label-header" style="margin: 4px 0">
          <div class="label-color" style="background: hsl(200 60% 50%)"></div>
          <span class="label-name" style="color: hsl(var(--muted-foreground))">Hiring</span>
        </div>
        <div class="stream-item" style="padding-left: 10px; color: hsl(var(--muted-foreground))">
          <div class="stream-icon">#</div>
          <span class="stream-name"># hiring</span>
        </div>
        <div class="neighbor-hint" data-target="auth">
          <div class="hint-color" style="background: hsl(280 60% 55%)"></div>
          <span>Auth Project</span>
        </div>
      </div>

      <!-- Main content -->
      <div class="main-content">
        <div class="max-w-xl">
          <h2 class="text-lg font-bold mb-2">Nav 11: Notion-Style Sidebar</h2>
          <p class="text-sm mb-4" style="color: hsl(var(--muted-foreground))">
            Toggle button pins/unpins sidebar. Color strip always visible. Hovering colors shows dock-like magnification
            with section preview. Supports left/right positioning.
          </p>
          <div class="p-4 rounded-xl" style="background: hsl(var(--muted))">
            <p class="text-sm font-medium mb-2">Interactions:</p>
            <ul class="text-sm space-y-1" style="color: hsl(var(--muted-foreground))">
              <li>‚Ä¢ <b>Toggle button:</b> Click to pin/unpin sidebar</li>
              <li>‚Ä¢ <b>Closed + hover toggle:</b> Slides sidebar as overlay</li>
              <li>‚Ä¢ <b>Closed + hover colors:</b> Dock-like magnification + section preview</li>
              <li>‚Ä¢ <b>Open:</b> Content shifts, sidebar takes space</li>
              <li>‚Ä¢ <b>Preview hints:</b> Neighboring sections shown, hoverable</li>
              <li>‚Ä¢ <b>Swap Side:</b> Move sidebar to left or right</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <script>
      const app = document.getElementById("app")
      const sidebarPanel = document.getElementById("sidebarPanel")
      const toggleBtn = document.getElementById("toggleBtn")
      const colorStrip = document.getElementById("colorStrip")
      const segments = document.querySelectorAll(".color-segment")
      const previews = document.querySelectorAll(".section-preview")

      let isOpen = false
      let activeSection = null

      // Toggle sidebar open/closed (pinned)
      function toggleSidebar() {
        isOpen = !isOpen
        app.classList.toggle("sidebar-open", isOpen)
        if (isOpen) {
          sidebarPanel.classList.remove("preview")
          hideAllPreviews()
        }
      }

      // Toggle side (left/right)
      function toggleSide() {
        app.classList.toggle("sidebar-right")
      }

      // Hide all section previews
      function hideAllPreviews() {
        previews.forEach((p) => p.classList.remove("visible"))
        segments.forEach((s) => {
          s.classList.remove("magnified", "neighbor", "far-neighbor")
        })
        activeSection = null
      }

      // Show section preview with dock-like effect
      function showSectionPreview(section, segmentEl) {
        if (isOpen) return

        activeSection = section

        // Apply dock-like magnification
        const segmentArray = Array.from(segments)
        const idx = segmentArray.indexOf(segmentEl)

        segments.forEach((s, i) => {
          s.classList.remove("magnified", "neighbor", "far-neighbor")
          const distance = Math.abs(i - idx)
          if (distance === 0) s.classList.add("magnified")
          else if (distance === 1) s.classList.add("neighbor")
          else if (distance === 2) s.classList.add("far-neighbor")
        })

        // Position and show preview
        const preview = document.getElementById(`preview-${section}`)
        if (preview) {
          hideAllPreviews()
          const rect = segmentEl.getBoundingClientRect()
          const isRight = app.classList.contains("sidebar-right")

          // Position preview near the hovered segment
          preview.style.top = `${Math.max(8, rect.top - 40)}px`

          // Re-apply magnification after hideAllPreviews
          segments.forEach((s, i) => {
            const distance = Math.abs(i - idx)
            if (distance === 0) s.classList.add("magnified")
            else if (distance === 1) s.classList.add("neighbor")
            else if (distance === 2) s.classList.add("far-neighbor")
          })

          preview.classList.add("visible")
        }
      }

      // Toggle button hover - show full sidebar as overlay
      toggleBtn.addEventListener("mouseenter", () => {
        if (!isOpen) {
          sidebarPanel.classList.add("preview")
          hideAllPreviews()
        }
      })

      toggleBtn.addEventListener("mouseleave", (e) => {
        // Check if moving to sidebar panel
        setTimeout(() => {
          if (!sidebarPanel.matches(":hover") && !toggleBtn.matches(":hover")) {
            sidebarPanel.classList.remove("preview")
          }
        }, 100)
      })

      sidebarPanel.addEventListener("mouseleave", () => {
        if (!isOpen) {
          sidebarPanel.classList.remove("preview")
        }
      })

      // Color strip hover - extended bounding box
      const stripBounds = { padding: 20 }

      colorStrip.addEventListener("mousemove", (e) => {
        if (isOpen) return

        // Find which segment is hovered
        segments.forEach((seg) => {
          const rect = seg.getBoundingClientRect()
          const isRight = app.classList.contains("sidebar-right")
          const inY = e.clientY >= rect.top && e.clientY <= rect.bottom
          const inX = isRight
            ? e.clientX >= rect.left - stripBounds.padding
            : e.clientX <= rect.right + stripBounds.padding

          if (inY) {
            const section = seg.dataset.section
            if (activeSection !== section) {
              showSectionPreview(section, seg)
            }
          }
        })
      })

      colorStrip.addEventListener("mouseleave", () => {
        if (!isOpen) {
          // Small delay to allow moving to preview
          setTimeout(() => {
            const anyPreviewHovered = Array.from(previews).some((p) => p.matches(":hover"))
            if (!anyPreviewHovered && !colorStrip.matches(":hover")) {
              hideAllPreviews()
            }
          }, 150)
        }
      })

      // Preview hover - keep it visible
      previews.forEach((preview) => {
        preview.addEventListener("mouseleave", () => {
          setTimeout(() => {
            if (!colorStrip.matches(":hover") && !preview.matches(":hover")) {
              hideAllPreviews()
            }
          }, 100)
        })

        // Neighbor hints - switch to that section
        preview.querySelectorAll(".neighbor-hint").forEach((hint) => {
          hint.addEventListener("mouseenter", () => {
            const target = hint.dataset.target
            const targetSeg = document.querySelector(`[data-section="${target}"]`)
            if (targetSeg) {
              showSectionPreview(target, targetSeg)
            }
          })
        })
      })

      // Click on preview item - could navigate
      document.querySelectorAll(".section-preview .stream-item").forEach((item) => {
        item.addEventListener("click", () => {
          console.log("Navigate to stream")
          hideAllPreviews()
        })
      })
    </script>
  </body>
</html>
