<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Nav 12: Aligned Color Strip</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      :root {
        --background: 40 20% 98%;
        --foreground: 30 10% 12%;
        --card: 40 15% 99%;
        --primary: 38 65% 50%;
        --primary-foreground: 40 20% 98%;
        --secondary: 35 10% 92%;
        --muted: 35 12% 93%;
        --muted-foreground: 30 8% 45%;
        --border: 35 15% 88%;

        /* Label colors */
        --label-auth: 280 60% 55%;
        --label-launch: 150 60% 45%;
        --label-design: 30 70% 50%;
        --label-hiring: 200 60% 50%;

        /* Activity colors */
        --activity-ai: 38 65% 50%;
        --activity-mention: 350 70% 50%;
        --activity-people: 200 60% 50%;
      }
      .dark {
        --background: 30 15% 8%;
        --foreground: 35 15% 92%;
        --card: 30 12% 11%;
        --primary: 40 55% 55%;
        --primary-foreground: 30 15% 8%;
        --secondary: 30 10% 18%;
        --muted: 30 10% 15%;
        --muted-foreground: 35 10% 55%;
        --border: 30 10% 20%;
      }
      body {
        background-color: hsl(var(--background));
        color: hsl(var(--foreground));
        font-family:
          system-ui,
          -apple-system,
          sans-serif;
      }

      .app-container {
        display: flex;
        min-height: 100vh;
      }
      .app-container.sidebar-right {
        flex-direction: row-reverse;
      }

      .main-content {
        flex: 1;
        padding: 24px;
        transition: margin 0.3s ease;
      }
      .app-container.sidebar-open .main-content {
        margin-left: var(--sidebar-width, 260px);
      }
      .app-container.sidebar-right.sidebar-open .main-content {
        margin-left: 0;
        margin-right: var(--sidebar-width, 260px);
      }

      /* Toggle button */
      .sidebar-toggle {
        position: fixed;
        top: 12px;
        left: 12px;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 6px;
        cursor: pointer;
        background: hsl(var(--card));
        border: 1px solid hsl(var(--border));
        z-index: 100;
        transition: all 0.2s ease;
      }
      .sidebar-toggle:hover {
        background: hsl(var(--muted));
      }
      .sidebar-toggle svg {
        width: 16px;
        height: 16px;
        color: hsl(var(--muted-foreground));
      }
      .app-container.sidebar-right .sidebar-toggle {
        left: auto;
        right: 12px;
      }

      /* Sidebar */
      .sidebar {
        position: fixed;
        top: 0;
        left: 0;
        bottom: 0;
        display: flex;
        z-index: 50;
        background: hsl(var(--card));
        border-right: 1px solid hsl(var(--border));
        width: var(--sidebar-width, 260px);
        transform: translateX(-100%);
        transition: transform 0.3s ease;
      }
      .app-container.sidebar-right .sidebar {
        left: auto;
        right: 0;
        flex-direction: row-reverse;
        border-right: none;
        border-left: 1px solid hsl(var(--border));
        transform: translateX(100%);
      }
      .app-container.sidebar-open .sidebar {
        transform: translateX(0);
        position: relative;
      }
      .sidebar.preview {
        transform: translateX(0);
        box-shadow: 4px 0 24px hsl(var(--foreground) / 0.08);
      }
      .app-container.sidebar-right .sidebar.preview {
        box-shadow: -4px 0 24px hsl(var(--foreground) / 0.08);
      }

      /* Color strip - uses LABEL colors, heights sync with content */
      .color-strip {
        width: 6px;
        display: flex;
        flex-direction: column;
        flex-shrink: 0;
        padding-top: 52px; /* Match content padding */
      }

      .color-segment {
        position: relative;
        transition: filter 0.15s ease;
      }
      .color-segment:hover {
        filter: brightness(1.1);
      }

      /* Activity indicator overlay on label color */
      .color-segment::after {
        content: "";
        position: absolute;
        right: 0;
        top: 4px;
        bottom: 4px;
        width: 3px;
        border-radius: 2px;
        opacity: 0;
        transition: opacity 0.2s ease;
      }
      .color-segment.has-activity::after {
        opacity: 1;
      }

      .color-auth {
        background: hsl(var(--label-auth));
      }
      .color-launch {
        background: hsl(var(--label-launch));
      }
      .color-design {
        background: hsl(var(--label-design));
      }
      .color-hiring {
        background: hsl(var(--label-hiring) / 0.4);
      }

      /* Activity overlay colors */
      .activity-ai::after {
        background: hsl(var(--activity-ai));
      }
      .activity-mention::after {
        background: hsl(var(--activity-mention));
      }
      .activity-people::after {
        background: hsl(var(--activity-people));
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.6;
        }
      }
      .activity-pulse::after {
        animation: pulse 2s ease-in-out infinite;
      }

      /* Sidebar content */
      .sidebar-content {
        flex: 1;
        overflow-y: auto;
        padding: 52px 8px 8px 8px;
      }

      /* Label sections */
      .label-section {
        margin-bottom: 4px;
      }

      .label-header {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px;
        cursor: pointer;
        border-radius: 8px;
        transition: background 0.15s ease;
      }
      .label-header:hover {
        background: hsl(var(--muted) / 0.5);
      }

      .label-dot {
        width: 10px;
        height: 10px;
        border-radius: 3px;
        flex-shrink: 0;
      }
      .label-name {
        font-size: 13px;
        font-weight: 600;
        flex: 1;
      }

      /* Activity glow bar next to label name */
      .label-activity {
        width: 4px;
        height: 18px;
        border-radius: 2px;
        flex-shrink: 0;
      }

      /* Stream items */
      .label-items {
        padding: 2px 0 8px 0;
      }

      .stream-item {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 8px 10px 8px 20px;
        border-radius: 6px;
        cursor: pointer;
        transition: background 0.15s ease;
      }
      .stream-item:hover {
        background: hsl(var(--muted) / 0.5);
      }

      /* Activity bar per stream - matches the label/activity colors */
      .stream-activity {
        width: 3px;
        height: 16px;
        border-radius: 2px;
        flex-shrink: 0;
      }

      .stream-icon {
        width: 20px;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        color: hsl(var(--muted-foreground));
        flex-shrink: 0;
      }
      .stream-name {
        font-size: 12px;
        flex: 1;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      .stream-badge {
        font-size: 9px;
        padding: 2px 5px;
        border-radius: 3px;
        background: hsl(var(--muted));
        color: hsl(var(--muted-foreground));
      }

      /* Muted state */
      .muted {
        color: hsl(var(--muted-foreground));
      }

      /* Resize handle */
      .resize-handle {
        position: absolute;
        top: 0;
        right: -4px;
        bottom: 0;
        width: 8px;
        cursor: ew-resize;
        z-index: 60;
      }
      .resize-handle:hover {
        background: hsl(var(--primary) / 0.1);
      }
      .app-container.sidebar-right .resize-handle {
        right: auto;
        left: -4px;
      }

      /* Controls */
      .controls {
        position: fixed;
        top: 12px;
        right: 16px;
        display: flex;
        gap: 8px;
        z-index: 100;
      }
      .control-btn {
        padding: 6px 12px;
        font-size: 11px;
        border-radius: 6px;
        cursor: pointer;
        background: hsl(var(--card));
        border: 1px solid hsl(var(--border));
        transition: all 0.15s ease;
      }
      .control-btn:hover {
        background: hsl(var(--muted));
      }
    </style>
  </head>
  <body>
    <div class="app-container sidebar-open" id="app">
      <div class="controls">
        <button class="control-btn" onclick="toggleSide()">Swap Side</button>
        <button onclick="document.body.classList.toggle('dark')" class="control-btn">Theme</button>
      </div>

      <button class="sidebar-toggle" id="toggleBtn" onclick="toggleSidebar()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="3" y="3" width="18" height="18" rx="2" />
          <line x1="9" y1="3" x2="9" y2="21" />
        </svg>
      </button>

      <div class="sidebar" id="sidebar">
        <!-- Color strip - synced heights with JS -->
        <div class="color-strip" id="colorStrip">
          <div class="color-segment color-auth has-activity activity-ai activity-pulse" data-section="auth"></div>
          <div class="color-segment color-launch has-activity activity-mention" data-section="launch"></div>
          <div class="color-segment color-design has-activity activity-people" data-section="design"></div>
          <div class="color-segment color-hiring" data-section="hiring"></div>
        </div>

        <div class="sidebar-content" id="sidebarContent">
          <!-- Auth Project -->
          <div class="label-section" data-section="auth">
            <div class="label-header">
              <div class="label-dot" style="background: hsl(var(--label-auth))"></div>
              <span class="label-name">Auth Project</span>
              <div class="label-activity" style="background: hsl(var(--activity-ai))"></div>
            </div>
            <div class="label-items">
              <div class="stream-item">
                <div class="stream-activity" style="background: hsl(var(--activity-ai))"></div>
                <div class="stream-icon">üìù</div>
                <span class="stream-name font-medium">Auth Scratchpad</span>
              </div>
              <div class="stream-item muted">
                <div class="stream-activity" style="background: transparent"></div>
                <div class="stream-icon">#</div>
                <span class="stream-name"># auth-dev</span>
              </div>
              <div class="stream-item muted">
                <div class="stream-activity" style="background: transparent"></div>
                <div class="stream-icon">‚Ü©</div>
                <span class="stream-name">Security review</span>
                <span class="stream-badge">thread</span>
              </div>
            </div>
          </div>

          <!-- Q1 Launch -->
          <div class="label-section" data-section="launch">
            <div class="label-header">
              <div class="label-dot" style="background: hsl(var(--label-launch))"></div>
              <span class="label-name">Q1 Launch</span>
              <div class="label-activity" style="background: hsl(var(--activity-mention))"></div>
            </div>
            <div class="label-items">
              <div class="stream-item">
                <div class="stream-activity" style="background: hsl(var(--activity-mention))"></div>
                <div class="stream-icon">#</div>
                <span class="stream-name font-semibold"># engineering</span>
              </div>
              <div class="stream-item">
                <div class="stream-activity" style="background: hsl(var(--activity-people))"></div>
                <div class="stream-icon">‚Ü©</div>
                <span class="stream-name">Launch planning</span>
                <span class="stream-badge">thread</span>
              </div>
            </div>
          </div>

          <!-- Design System -->
          <div class="label-section" data-section="design">
            <div class="label-header">
              <div class="label-dot" style="background: hsl(var(--label-design))"></div>
              <span class="label-name">Design System</span>
              <div class="label-activity" style="background: hsl(var(--activity-people))"></div>
            </div>
            <div class="label-items">
              <div class="stream-item">
                <div class="stream-activity" style="background: hsl(var(--activity-people))"></div>
                <div class="stream-icon">#</div>
                <span class="stream-name"># design</span>
              </div>
              <div class="stream-item muted">
                <div class="stream-activity" style="background: transparent"></div>
                <div class="stream-icon">üìù</div>
                <span class="stream-name">Component ideas</span>
              </div>
            </div>
          </div>

          <!-- Hiring -->
          <div class="label-section" data-section="hiring">
            <div class="label-header">
              <div class="label-dot" style="background: hsl(var(--label-hiring))"></div>
              <span class="label-name muted">Hiring</span>
            </div>
            <div class="label-items">
              <div class="stream-item muted">
                <div class="stream-activity" style="background: transparent"></div>
                <div class="stream-icon">#</div>
                <span class="stream-name"># hiring</span>
              </div>
            </div>
          </div>
        </div>

        <div class="resize-handle" id="resizeHandle"></div>
      </div>

      <div class="main-content">
        <div class="max-w-xl">
          <h2 class="text-lg font-bold mb-2">Nav 12: Aligned Color Strip</h2>
          <p class="text-sm mb-4" style="color: hsl(var(--muted-foreground))">
            Color strip now uses label colors (purple, green, orange, blue) and segment heights match section heights.
            Activity indicators overlay on the label color.
          </p>
          <div class="p-4 rounded-xl" style="background: hsl(var(--muted))">
            <p class="text-sm font-medium mb-2">Color system:</p>
            <ul class="text-sm space-y-1" style="color: hsl(var(--muted-foreground))">
              <li>‚Ä¢ <b>Strip color</b> = Label color (purple, green, orange, blue)</li>
              <li>‚Ä¢ <b>Activity overlay</b> = Small bar on right edge of strip</li>
              <li>‚Ä¢ <b>Gold</b> = AI activity</li>
              <li>‚Ä¢ <b>Red</b> = Mentions</li>
              <li>‚Ä¢ <b>Blue</b> = People online</li>
              <li>‚Ä¢ Heights sync automatically with section content</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <script>
      const app = document.getElementById("app")
      const sidebar = document.getElementById("sidebar")
      const toggleBtn = document.getElementById("toggleBtn")
      const colorStrip = document.getElementById("colorStrip")
      const sidebarContent = document.getElementById("sidebarContent")
      const resizeHandle = document.getElementById("resizeHandle")

      let isOpen = true

      function toggleSidebar() {
        isOpen = !isOpen
        app.classList.toggle("sidebar-open", isOpen)
        if (!isOpen) {
          sidebar.classList.remove("preview")
        }
      }

      function toggleSide() {
        app.classList.toggle("sidebar-right")
      }

      // Sync color strip heights with section heights
      function syncHeights() {
        const sections = document.querySelectorAll(".label-section")
        const segments = document.querySelectorAll(".color-segment")

        sections.forEach((section, i) => {
          if (segments[i]) {
            const height = section.offsetHeight
            segments[i].style.height = `${height}px`
          }
        })
      }

      // Initial sync and on resize
      syncHeights()
      window.addEventListener("resize", syncHeights)

      // Re-sync when content might change
      const observer = new MutationObserver(syncHeights)
      observer.observe(sidebarContent, { childList: true, subtree: true })

      // Toggle button hover
      toggleBtn.addEventListener("mouseenter", () => {
        if (!isOpen) {
          sidebar.classList.add("preview")
        }
      })

      toggleBtn.addEventListener("mouseleave", () => {
        setTimeout(() => {
          if (!sidebar.matches(":hover") && !toggleBtn.matches(":hover") && !isOpen) {
            sidebar.classList.remove("preview")
          }
        }, 100)
      })

      sidebar.addEventListener("mouseleave", () => {
        if (!isOpen) {
          sidebar.classList.remove("preview")
        }
      })

      // Resize
      let isResizing = false
      resizeHandle.addEventListener("mousedown", (e) => {
        isResizing = true
        document.body.style.cursor = "ew-resize"
        document.body.style.userSelect = "none"
        e.preventDefault()
      })

      document.addEventListener("mousemove", (e) => {
        if (!isResizing) return
        const isRight = app.classList.contains("sidebar-right")
        const x = isRight ? window.innerWidth - e.clientX : e.clientX
        const width = Math.min(400, Math.max(160, x))
        app.style.setProperty("--sidebar-width", `${width}px`)
      })

      document.addEventListener("mouseup", () => {
        if (isResizing) {
          isResizing = false
          document.body.style.cursor = ""
          document.body.style.userSelect = ""
        }
      })
    </script>
  </body>
</html>
