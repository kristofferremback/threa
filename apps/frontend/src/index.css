@import url("https://fonts.cdnfonts.com/css/opendyslexic");

@tailwind base;
@tailwind components;
@tailwind utilities;

/*
 * Threa - Golden Thread Theme
 *
 * Design concept: Neutral, slightly warm canvas with amber/gold accents
 * inspired by Ariadne's thread. The gold appears sparingly as the
 * "guiding thread" through the interface.
 */

@layer base {
  :root {
    /* Base canvas - very subtle warm tint */
    --background: 40 20% 98%;
    --foreground: 30 10% 12%;

    /* Cards/popovers - slightly elevated from background */
    --card: 40 15% 99%;
    --card-foreground: 30 10% 12%;
    --popover: 40 15% 99%;
    --popover-foreground: 30 10% 12%;

    /* Primary - The Golden Thread
     * This is your brand signature. Used for:
     * - Primary buttons
     * - Active states
     * - Key interactive elements
     * - The "thread" that guides users
     */
    --primary: 38 65% 50%;
    --primary-foreground: 40 20% 98%;

    /* Secondary - Warm neutral for less prominent actions */
    --secondary: 35 10% 92%;
    --secondary-foreground: 30 15% 25%;

    /* Muted - Subdued backgrounds and text */
    --muted: 35 12% 93%;
    --muted-foreground: 30 8% 45%;

    /* Accent - Lighter gold for hover states, highlights */
    --accent: 40 50% 94%;
    --accent-foreground: 35 60% 35%;

    /* Destructive - Warm red that harmonizes with gold */
    --destructive: 8 70% 55%;
    --destructive-foreground: 0 0% 100%;

    /* Borders and inputs - subtle warm gray */
    --border: 35 15% 88%;
    --input: 35 15% 88%;

    /* Ring - gold for focus states (the thread highlighting where you are) */
    --ring: 38 65% 50%;

    /* Radius - slightly rounded, not too playful */
    --radius: 0.5rem;

    /* Sidebar - Slightly darker than main canvas for visual hierarchy */
    --sidebar-background: 35 15% 96%;
    --sidebar-foreground: 30 10% 25%;
    --sidebar-primary: 38 65% 50%;
    --sidebar-primary-foreground: 40 20% 98%;
    --sidebar-accent: 40 40% 92%;
    --sidebar-accent-foreground: 35 50% 30%;
    --sidebar-border: 35 12% 90%;
    --sidebar-ring: 38 65% 50%;

    /* Chart colors - gold-adjacent palette */
    --chart-1: 38 65% 50%;
    --chart-2: 25 55% 45%;
    --chart-3: 45 50% 55%;
    --chart-4: 15 45% 50%;
    --chart-5: 50 35% 60%;
  }

  .dark {
    /* Base canvas - deep charcoal with slight warmth */
    --background: 30 15% 8%;
    --foreground: 35 15% 92%;

    /* Cards/popovers - slightly elevated */
    --card: 30 12% 11%;
    --card-foreground: 35 15% 92%;
    --popover: 30 12% 11%;
    --popover-foreground: 35 15% 92%;

    /* Primary - Gold adjusted for dark mode
     * Slightly desaturated to avoid glowing effect
     */
    --primary: 40 55% 55%;
    --primary-foreground: 30 15% 8%;

    /* Secondary */
    --secondary: 30 10% 18%;
    --secondary-foreground: 35 12% 85%;

    /* Muted */
    --muted: 30 10% 15%;
    --muted-foreground: 35 10% 55%;

    /* Accent - darker gold tint */
    --accent: 35 25% 18%;
    --accent-foreground: 40 45% 70%;

    /* Destructive */
    --destructive: 5 65% 48%;
    --destructive-foreground: 0 0% 100%;

    /* Borders and inputs */
    --border: 30 10% 20%;
    --input: 30 10% 20%;

    /* Ring */
    --ring: 40 55% 55%;

    /* Sidebar */
    --sidebar-background: 30 15% 6%;
    --sidebar-foreground: 35 12% 85%;
    --sidebar-primary: 40 55% 55%;
    --sidebar-primary-foreground: 30 15% 8%;
    --sidebar-accent: 35 20% 15%;
    --sidebar-accent-foreground: 40 40% 75%;
    --sidebar-border: 30 10% 15%;
    --sidebar-ring: 40 55% 55%;

    /* Chart colors - adjusted for dark */
    --chart-1: 40 55% 55%;
    --chart-2: 25 50% 50%;
    --chart-3: 48 45% 60%;
    --chart-4: 15 40% 55%;
    --chart-5: 50 30% 55%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
    font-family:
      "Space Grotesk",
      system-ui,
      -apple-system,
      BlinkMacSystemFont,
      "Segoe UI",
      sans-serif;
  }
}

/*
 * Custom utility classes for the golden thread
 * Use sparingly for key UI moments
 */
@layer utilities {
  /* Subtle gold gradient for special surfaces */
  .thread-gradient {
    background: linear-gradient(135deg, hsl(var(--background)) 0%, hsl(40 30% 95%) 100%);
  }

  .dark .thread-gradient {
    background: linear-gradient(135deg, hsl(var(--background)) 0%, hsl(35 20% 12%) 100%);
  }

  /* Gold text for emphasis (use very sparingly) */
  .text-thread {
    color: hsl(var(--primary));
  }

  /* Subtle gold border for "active" or "connected" states */
  .border-thread {
    border-color: hsl(var(--primary) / 0.3);
  }

  /* Glow effect for key moments (notifications, @mentions) */
  .thread-glow {
    box-shadow: 0 0 20px hsl(var(--primary) / 0.15);
  }

  .dark .thread-glow {
    box-shadow: 0 0 20px hsl(var(--primary) / 0.1);
  }

  /* Premium glow effect for focused inputs */
  .input-glow-wrapper {
    position: relative;
  }

  .input-glow-wrapper::before {
    content: "";
    position: absolute;
    inset: -2px;
    border-radius: 14px;
    background: linear-gradient(
      135deg,
      hsl(var(--primary) / 0.2),
      hsl(var(--primary) / 0.05),
      hsl(var(--primary) / 0.2)
    );
    opacity: 0;
    transition: opacity 0.3s ease;
    pointer-events: none;
    z-index: -1;
  }

  .input-glow-wrapper:focus-within::before {
    opacity: 1;
  }

  /* Activity indicator dot */
  .activity-dot {
    @apply w-2 h-2 rounded-full bg-primary;
  }

  .activity-dot.recent {
    @apply animate-activity-pulse;
  }

  /* Search result highlight */
  .search-highlight mark {
    background: hsl(var(--primary) / 0.3);
    color: hsl(var(--foreground));
    padding: 0 2px;
    border-radius: 2px;
  }
}

/*
 * Tiptap Editor Styles
 */
.ProseMirror {
  @apply outline-none;
}

.ProseMirror p.is-editor-empty:first-child::before {
  @apply text-muted-foreground pointer-events-none float-left h-0;
  content: attr(data-placeholder);
}

.ProseMirror > * + * {
  @apply mt-2;
}

.ProseMirror p {
  @apply my-0;
}

.ProseMirror h1 {
  @apply text-xl font-bold mt-4 mb-2 first:mt-0;
}

.ProseMirror h2 {
  @apply text-lg font-bold mt-3 mb-2 first:mt-0;
}

.ProseMirror h3 {
  @apply text-base font-semibold mt-3 mb-1 first:mt-0;
}

.ProseMirror strong {
  @apply font-semibold;
}

.ProseMirror em {
  @apply italic;
}

.ProseMirror s {
  @apply line-through text-muted-foreground;
}

.ProseMirror code {
  @apply bg-muted px-1.5 py-0.5 rounded text-sm font-mono;
}

.ProseMirror pre {
  @apply bg-muted rounded-md p-4 my-2 font-mono text-sm overflow-x-auto;
}

.ProseMirror pre code {
  @apply bg-transparent p-0 rounded-none;
}

.ProseMirror ul {
  @apply list-disc pl-6 my-2;
}

.ProseMirror ol {
  @apply list-decimal pl-6 my-2;
}

.ProseMirror li {
  @apply mb-1;
}

.ProseMirror li p {
  @apply my-0;
}

.ProseMirror blockquote {
  @apply border-l-2 border-primary/50 pl-4 my-2 text-muted-foreground italic;
}

.ProseMirror hr {
  @apply my-4 border-border;
}

/*
 * Shiki syntax highlighting - dual theme support
 *
 * Shiki's dual-theme mode (used in code-block.tsx with `themes: { light, dark }`)
 * outputs inline styles using CSS custom properties: --shiki-light, --shiki-dark, etc.
 * These selectors switch between the light/dark values based on the current theme.
 *
 * The theme names in code-block.tsx ("github-light", "github-dark") determine the
 * color values, while these CSS rules determine which set of values to apply.
 */
.shiki,
.shiki span {
  color: var(--shiki-light);
  background-color: var(--shiki-light-bg);
}

.dark .shiki,
.dark .shiki span {
  color: var(--shiki-dark);
  background-color: var(--shiki-dark-bg);
}

/*
 * Accessibility - User Preference Styles
 */

/* Reduced Motion - disable animations for users who prefer reduced motion */
.reduced-motion *,
.reduced-motion *::before,
.reduced-motion *::after {
  animation-duration: 0.01ms !important;
  animation-iteration-count: 1 !important;
  transition-duration: 0.01ms !important;
  scroll-behavior: auto !important;
}

/* High Contrast - increase visual distinction */
.high-contrast {
  --border: 0 0% 20%;
  --ring: 0 0% 0%;
}

.dark.high-contrast {
  --border: 0 0% 80%;
  --ring: 0 0% 100%;
}

/* Font Sizes */
[data-font-size="small"] {
  font-size: 14px;
}

[data-font-size="medium"] {
  font-size: 16px;
}

[data-font-size="large"] {
  font-size: 18px;
}

/* Font Families */
[data-font-family="system"] {
  font-family:
    system-ui,
    -apple-system,
    BlinkMacSystemFont,
    "Segoe UI",
    Roboto,
    sans-serif;
}

[data-font-family="monospace"] {
  font-family: ui-monospace, SFMono-Regular, "SF Mono", Menlo, Monaco, Consolas, monospace;
}

[data-font-family="dyslexic"] {
  font-family: "OpenDyslexic", system-ui, sans-serif;
}

/* Message Display - Compact mode reduces spacing in the timeline */
[data-message-display="compact"] .message-item {
  padding-top: 0.25rem;
  padding-bottom: 0.25rem;
}

[data-message-display="compact"] .message-avatar {
  width: 1.5rem;
  height: 1.5rem;
}

[data-message-display="compact"] .message-content {
  gap: 0.5rem;
}
